<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animals Picture</title>
    <meta name="description" content="A rede social dos animais.">
    <meta name="theme-color" content="#121212">
    
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6566744182494017" crossorigin="anonymous"></script>

    <style>
        /* === TEMA ESCURO === */
        :root {
            --bg: #121212; --card: #1e1e1e; --text: #e0e0e0;
            --border: #333; --green: #00C853; --red: #D50000; --gold: #FFD700;
        }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; flex-direction: column; align-items: center; }
        
        /* HEADER */
        header { width: 100%; height: 70px; background: var(--card); display: flex; align-items: center; justify-content: space-between; padding: 0 20px; box-sizing: border-box; border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 100; }
        .logo { font-size: 22px; font-weight: 800; color: var(--green); margin: 0; }
        .logo span { color: #fff; }
        .header-actions { display: flex; align-items: center; gap: 12px; }

        .btn-icon { background: transparent; border: 1px solid var(--border); color: var(--text); width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px; transition: 0.2s; }
        .btn-icon:hover { background: #333; border-color: var(--green); }
        .btn-premium { background: rgba(255, 215, 0, 0.1); border-color: var(--gold); color: var(--gold); }
        .user-mini img { width: 38px; height: 38px; border-radius: 50%; border: 2px solid var(--green); cursor: pointer; object-fit: cover; }
        .premium-border { border: 2px solid var(--gold) !important; box-shadow: 0 0 5px var(--gold); }
        .admin-border { border: 2px solid var(--red) !important; box-shadow: 0 0 5px var(--red); }

        /* NAVEGA√á√ÉO */
        .topic-bar { width: 100%; background: var(--bg); border-bottom: 1px solid var(--border); display: flex; gap: 10px; padding: 12px; overflow-x: auto; position: sticky; top: 70px; z-index: 90; }
        .topic-btn { background: var(--card); border: 1px solid var(--border); color: #aaa; padding: 8px 18px; border-radius: 20px; cursor: pointer; white-space: nowrap; }
        .topic-btn.active { background: var(--green); color: white; border-color: var(--green); }

        /* MAIN & CARDS */
        main { width: 100%; max-width: 600px; padding: 20px 10px; padding-bottom: 80px; }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; margin-bottom: 25px; }
        
        input, textarea, select { width: 100%; background: #2c2c2c; border: 1px solid var(--border); color: white; padding: 12px; border-radius: 8px; margin: 8px 0; box-sizing: border-box; }
        .btn-green { width: 100%; background: var(--green); color: white; border: none; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        
        /* POSTS */
        .post img { width: 100%; border-radius: 10px; margin-top: 10px; }
        .post-header { display: flex; align-items: center; justify-content: space-between; }
        .post-user { display: flex; align-items: center; gap: 10px; }
        .post-avatar { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }
        .badge-admin { background: var(--red); color: white; font-size: 9px; padding: 2px 6px; border-radius: 4px; margin-left: 5px; font-weight: bold; }
        
        /* COMENT√ÅRIOS */
        .post-comments { margin-top: 15px; border-top: 1px solid #333; padding-top: 10px; }
        .comment-item { display: flex; gap: 10px; margin-bottom: 10px; }
        .comment-avatar { width: 30px; height: 30px; border-radius: 50%; }
        .comment-text { font-size: 13px; color: #ccc; background: #252525; padding: 8px; border-radius: 8px; flex: 1; }
        .comment-form { display: flex; gap: 8px; margin-top: 10px; }
        .btn-comment { background: var(--green); border: none; color: white; border-radius: 8px; padding: 0 15px; cursor: pointer; }

        /* ADS & MODAIS */
        .post-ad { border: 2px dashed #444; background: #000; text-align: center; }
        .modal-bg { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; align-items: center; justify-content: center; }
        .modal-bg.open { display: flex; }
        .modal-box { background: var(--card); width: 90%; max-width: 400px; padding: 25px; border-radius: 16px; border: 1px solid var(--border); position: relative; }
        .close-btn { position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; color: #888; }
        
        .config-section { border-top: 1px solid #333; margin-top: 15px; padding-top: 15px; }
        .config-link { color: var(--green); text-decoration: none; }
    </style>
</head>
<body>

    <header>
        <div class="logo">Animals <span>Picture</span></div>
        <div class="header-actions">
            <button class="btn-icon btn-premium" onclick="abrirModal('modalPremium')" title="Premium">üíé</button>
            <button class="btn-icon" onclick="abrirModal('modalConfig')" title="Config">‚öôÔ∏è</button>
            <div id="googleBtn"></div>
            <div class="user-mini" id="loggedArea" onclick="abrirModal('modalPerfil')" style="display:none;">
                <img id="headerImg" src="" alt="Eu">
            </div>
        </div>
    </header>

    <nav id="topicBar" class="topic-bar">
        <button class="topic-btn active" onclick="filtrarFeed('Tudo', this)" data-i18n="all">Tudo</button>
    </nav>

    <main>
        <div id="postBox" class="card" style="display:none;">
            <h3 data-i18n="newPost">Nova Publica√ß√£o üêæ</h3>
            <form onsubmit="publicar(event)">
                <textarea id="descPost" rows="2" required></textarea>
                <div style="display:flex; gap:10px; margin:10px 0;">
                    <select id="catSelect" required onchange="carregarSub()"><option value="">Categoria...</option></select>
                    <select id="subSelect" disabled required><option value="">Ra√ßa...</option></select>
                </div>
                <input type="url" id="imgUrlPost" placeholder="URL da imagem..." required>
                <button class="btn-green" data-i18n="publishBtn">Publicar</button>
                <div id="limitDisplay" style="font-size:12px; color:#888; margin-top:5px; text-align:center;"></div>
            </form>
        </div>

        <div id="feed"></div>
    </main>

    <div id="modalPremium" class="modal-bg">
        <div class="modal-box">
            <span class="close-btn" onclick="fecharModal('modalPremium')">&times;</span>
            <h2 style="color:var(--gold)">Premium üíé</h2>
            <p>R$ 2,99 / m√™s</p>
            <ul style="text-align:left; color:#aaa;">
                <li data-i18n="feat1">Posts Ilimitados</li>
                <li data-i18n="feat2">Zero An√∫ncios</li>
            </ul>
            <button class="btn-green" style="background:var(--gold); color:black;" onclick="assinarPremium()">Assinar</button>
        </div>
    </div>

    <div id="modalPerfil" class="modal-bg">
        <div class="modal-box">
            <span class="close-btn" onclick="fecharModal('modalPerfil')">&times;</span>
            <h3 data-i18n="profile">Meu Perfil</h3>
            <img id="previewImg" src="" style="width:80px; height:80px; border-radius:50%; margin:10px auto; display:block; object-fit:cover;">
            <input type="text" id="editNome" placeholder="Nome">
            <input type="text" id="editFoto" placeholder="URL da Foto" oninput="atualizarPreview()">
            <button class="btn-green" onclick="salvarPerfil()" data-i18n="save">Salvar</button>
        </div>
    </div>

    <div id="modalConfig" class="modal-bg">
        <div class="modal-box">
            <span class="close-btn" onclick="fecharModal('modalConfig')">&times;</span>
            <h3 data-i18n="config">Configura√ß√µes</h3>
            
            <div class="config-section">
                <h4 data-i18n="lang">Idioma</h4>
                <select id="selectIdioma" onchange="mudarIdioma(this.value)">
                    <option value="pt">Portugu√™s</option>
                    <option value="en">English</option>
                </select>
            </div>

            <div class="config-section">
                <h4>Suporte</h4>
                <a class="config-link" href="mailto:animalspicturehelp@gmail.com">animalspicturehelp@gmail.com</a>
            </div>

            <div class="config-section">
                <p style="font-size:12px; color:#666;">Logado como: <br><b id="userEmailDisplay">---</b></p>
                <button class="btn-green" style="background:var(--red);" onclick="logout()" data-i18n="logout">Sair</button>
            </div>
        </div>
    </div>

    <script>
        // === 1. DICION√ÅRIO DE IDIOMAS ===
        const TRANSLATIONS = {
            pt: {
                all: "Tudo", newPost: "Nova Publica√ß√£o üêæ", publishBtn: "Publicar",
                feat1: "‚úÖ Posts Ilimitados", feat2: "‚úÖ Zero An√∫ncios",
                profile: "Meu Perfil", save: "Salvar", config: "Configura√ß√µes",
                lang: "Idioma", logout: "Sair da Conta",
                descPlace: "Escreva algo...", imgPlace: "Link da imagem (URL)...",
                catPlace: "Categoria...", racePlace: "Ra√ßa..."
            },
            en: {
                all: "All", newPost: "New Post üêæ", publishBtn: "Publish",
                feat1: "‚úÖ Unlimited Posts", feat2: "‚úÖ No Ads",
                profile: "My Profile", save: "Save", config: "Settings",
                lang: "Language", logout: "Logout",
                descPlace: "Write something...", imgPlace: "Image Link (URL)...",
                catPlace: "Category...", racePlace: "Breed..."
            }
        };

        const ADMIN_EMAIL = "jarvismorato@gmail.com"; 
        const LIMITE = 29;
        const CATEGORIAS = {
            "C√£es": ["Vira-lata", "Labrador", "Poodle", "Bulldog"],
            "Gatos": ["Vira-lata", "Siam√™s", "Persa"],
            "P√°ssaros": ["Calopsita", "Papagaio"],
            "Outros": ["Ex√≥tico"]
        };

        let usuario = { nome: "", foto: "", email: "", premium: false };
        let postsHoje = 0;
        let contadorSessao = 0;
        let idiomaAtual = localStorage.getItem('app_lang') || 'pt';

        window.onload = function() {
            google.accounts.id.initialize({
                client_id: "1011026636052-883kh3h1md3m98tpvgvm5gqlie40lecc.apps.googleusercontent.com",
                callback: handleLogin
            });
            google.accounts.id.renderButton(document.getElementById("googleBtn"), { theme: "outline", size: "large", type: "icon" });

            carregarDados();
            initCategorias();
            aplicarIdioma(idiomaAtual);
            renderizarFeedExemplo(); // Carrega post de exemplo se vazio
        };

        // === 2. SISTEMA DE LOGIN & DADOS ===
        function handleLogin(res) {
            const data = decodeJwt(res.credential);
            
            // L√ìGICA DA FOTO: S√≥ usa a do Google se n√£o tiver uma personalizada salva
            const fotoSalva = localStorage.getItem('app_foto');
            usuario.foto = fotoSalva ? fotoSalva : data.picture;
            
            usuario.nome = localStorage.getItem('app_nome') || data.name;
            usuario.email = data.email;
            
            localStorage.setItem('app_email', usuario.email);
            if(!fotoSalva) localStorage.setItem('app_foto', usuario.foto);
            if(!localStorage.getItem('app_nome')) localStorage.setItem('app_nome', usuario.nome);

            atualizarUI();
        }

        function carregarDados() {
            usuario.nome = localStorage.getItem('app_nome');
            usuario.foto = localStorage.getItem('app_foto');
            usuario.email = localStorage.getItem('app_email');
            usuario.premium = localStorage.getItem('app_premium') === 'true';
            
            let hoje = new Date().toLocaleDateString();
            if(localStorage.getItem('app_data') !== hoje) {
                postsHoje = 0; localStorage.setItem('app_data', hoje);
            } else {
                postsHoje = parseInt(localStorage.getItem('app_qtd') || 0);
            }
            atualizarUI();
        }

        function atualizarUI() {
            if(usuario.email) {
                document.getElementById('googleBtn').style.display = 'none';
                document.getElementById('loggedArea').style.display = 'flex';
                document.getElementById('postBox').style.display = 'block';
                document.getElementById('headerImg').src = usuario.foto;
                document.getElementById('editNome').value = usuario.nome;
                document.getElementById('editFoto').value = usuario.foto;
                document.getElementById('previewImg').src = usuario.foto;
                document.getElementById('userEmailDisplay').innerText = usuario.email;
                
                // Bordas
                const img = document.getElementById('headerImg');
                img.className = '';
                if(isAdmin()) img.classList.add('admin-border');
                else if(usuario.premium) img.classList.add('premium-border');
            }
            atualizarLimite();
        }

        // === 3. IDIOMA ===
        function mudarIdioma(lang) {
            idiomaAtual = lang;
            localStorage.setItem('app_lang', lang);
            aplicarIdioma(lang);
        }

        function aplicarIdioma(lang) {
            const t = TRANSLATIONS[lang];
            document.getElementById('selectIdioma').value = lang;
            
            // Textos simples
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if(t[key]) el.innerText = t[key];
            });

            // Placeholders
            document.getElementById('descPost').placeholder = t.descPlace;
            document.getElementById('imgUrlPost').placeholder = t.imgPlace;
            document.getElementById('catSelect').options[0].text = t.catPlace;
            document.getElementById('subSelect').options[0].text = t.racePlace;
        }

        // === 4. PUBLICAR & COMENT√ÅRIOS ===
        function isAdmin() {
            return usuario.email && (usuario.email.toLowerCase() === ADMIN_EMAIL.toLowerCase());
        }

        function publicar(e) {
            e.preventDefault();
            if(!usuario.premium && !isAdmin() && postsHoje >= LIMITE) {
                alert("Limite di√°rio atingido!"); abrirModal('modalPremium'); return;
            }

            const desc = document.getElementById('descPost').value;
            const img = document.getElementById('imgUrlPost').value;
            const cat = document.getElementById('catSelect').value;
            const sub = document.getElementById('subSelect').value;

            if(!cat || !sub) return alert("Selecione Categoria/Ra√ßa");

            const postID = 'post_' + Date.now();
            criarPostHTML(postID, usuario.nome, usuario.foto, desc, img, cat, sub);

            if(!usuario.premium && !isAdmin()) {
                postsHoje++; localStorage.setItem('app_qtd', postsHoje);
                contadorSessao++;
                if(contadorSessao % 10 === 0) inserirAnuncio();
                atualizarLimite();
            }
            
            e.target.reset();
        }

        function criarPostHTML(id, nome, foto, desc, imgUrl, cat, sub) {
            const div = document.createElement('div');
            div.className = 'card post';
            div.setAttribute('data-cat', cat);
            div.setAttribute('data-id', id);
            
            let badge = "";
            let borderClass = "";
            if(isAdmin()) { badge = " <span class='badge-admin'>DONO</span>"; borderClass = "admin-border"; }
            else if(usuario.premium) { borderClass = "premium-border"; }

            div.innerHTML = `
                <div class="post-header">
                    <div class="post-user">
                        <img src="${foto}" class="post-avatar ${borderClass}">
                        <div><b>${nome}${badge}</b></div>
                    </div>
                    ${isAdmin() ? `<button class="btn-icon" style="border:none; color:red;" onclick="this.closest('.card').remove()">üóëÔ∏è</button>` : ''}
                </div>
                <p>${desc}</p>
                <span style="font-size:11px; background:#333; padding:4px 8px; border-radius:4px;">${cat} > ${sub}</span>
                <img src="${imgUrl}">
                <div class="post-comments">
                    <div class="comments-list" id="list-${id}"></div>
                    ${usuario.email ? 
                    `<div class="comment-form">
                        <input type="text" placeholder="Comente..." id="input-${id}" style="flex:1;">
                        <button class="btn-comment" onclick="addComentario('${id}')">></button>
                    </div>` : '<small>Logue para comentar</small>'}
                </div>
            `;
            document.getElementById('feed').prepend(div);
            carregarComentarios(id);
        }

        // Sistema de Coment√°rios (Salvos no LocalStorage)
        function addComentario(postID) {
            const input = document.getElementById(`input-${postID}`);
            const texto = input.value;
            if(!texto) return;

            const novoComentario = { user: usuario.nome, foto: usuario.foto, text: texto };
            
            // Salva
            let todos = JSON.parse(localStorage.getItem('comments') || '{}');
            if(!todos[postID]) todos[postID] = [];
            todos[postID].push(novoComentario);
            localStorage.setItem('comments', JSON.stringify(todos));

            renderComentario(postID, novoComentario);
            input.value = '';
        }

        function carregarComentarios(postID) {
            let todos = JSON.parse(localStorage.getItem('comments') || '{}');
            if(todos[postID]) {
                todos[postID].forEach(c => renderComentario(postID, c));
            }
        }

        function renderComentario(postID, c) {
            const list = document.getElementById(`list-${postID}`);
            const div = document.createElement('div');
            div.className = 'comment-item';
            div.innerHTML = `
                <img src="${c.foto}" class="comment-avatar">
                <div class="comment-text"><b>${c.user}:</b> ${c.text}</div>
            `;
            list.appendChild(div);
        }

        // === UTILIT√ÅRIOS ===
        function inserirAnuncio() {
            const div = document.createElement('div');
            div.className = 'card post post-ad';
            div.innerHTML = `
                <span style="background:#FFD700; color:black; padding:2px 5px; font-weight:bold; font-size:10px;">AD</span>
                <div style="padding:20px;">
                    <ins class="adsbygoogle"
                         style="display:block"
                         data-ad-client="ca-pub-6566744182494017"
                         data-ad-slot="SEU_SLOT_AQUI"
                         data-ad-format="auto"
                         data-full-width-responsive="true"></ins>
                    <script>(adsbygoogle = window.adsbygoogle || []).push({});<\/script>
                </div>
                <small onclick="abrirModal('modalPremium')" style="cursor:pointer; text-decoration:underline;">Remover (R$ 2,99)</small>
            `;
            document.getElementById('feed').prepend(div);
        }

        function renderizarFeedExemplo() {
            // Cria um post fixo de exemplo se quiser
            criarPostHTML('demo', 'Admin', 'https://ui-avatars.com/api/?name=Admin', 'Bem-vindo ao Animals Picture! üê∂', 'https://images.unsplash.com/photo-1533738363-b7f9aef128ce?w=600&q=80', 'Sistema', 'Info');
        }

        function salvarPerfil() {
            const nome = document.getElementById('editNome').value;
            const foto = document.getElementById('editFoto').value;
            if(nome) { usuario.nome = nome; localStorage.setItem('app_nome', nome); }
            if(foto) { usuario.foto = foto; localStorage.setItem('app_foto', foto); }
            
            atualizarUI();
            fecharModal('modalPerfil');
        }

        function initCategorias() {
            const sel = document.getElementById('catSelect');
            const top = document.getElementById('topicBar');
            for(let c in CATEGORIAS) {
                sel.innerHTML += `<option value="${c}">${c}</option>`;
                top.innerHTML += `<button class="topic-btn" onclick="filter('${c}', this)">${c}</button>`;
            }
        }
        function carregarSub() {
            const c = document.getElementById('catSelect').value;
            const s = document.getElementById('subSelect');
            s.innerHTML = '<option value="">Ra√ßa...</option>';
            s.disabled = !c;
            if(c) CATEGORIAS[c].forEach(r => s.innerHTML += `<option value="${r}">${r}</option>`);
        }
        function filter(cat, btn) {
            document.querySelectorAll('.topic-btn').forEach(b=>b.classList.remove('active'));
            if(btn) btn.classList.add('active');
            document.querySelectorAll('.post').forEach(p => {
                p.style.display = (cat === 'Tudo' || p.getAttribute('data-cat') === cat) ? 'block' : 'none';
            });
        }

        function atualizarPreview() { document.getElementById('previewImg').src = document.getElementById('editFoto').value; }
        function atualizarLimite() { 
            const el = document.getElementById('limitDisplay');
            if(isAdmin() || usuario.premium) el.innerText = "Ilimitado ‚ú®";
            else el.innerText = `Restam ${LIMITE - postsHoje} posts hoje.`;
        }
        function abrirModal(id) { document.getElementById(id).classList.add('open'); }
        function fecharModal(id) { document.getElementById(id).classList.remove('open'); }
        function logout() { localStorage.clear(); location.reload(); }
        function decodeJwt(t) { return JSON.parse(decodeURIComponent(window.atob(t.split('.')[1].replace(/-/g, '+').replace(/_/g, '/')).split('').map(c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join(''))); }
        
        function assinarPremium() {
            if(confirm("Pagar R$ 2,99?")) {
                usuario.premium = true; localStorage.setItem('app_premium', 'true');
                atualizarUI(); fecharModal('modalPremium'); alert("Voc√™ agora √© Premium!");
            }
        }
    </script>
</body>
</html>